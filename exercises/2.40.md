## Exercise 2.40

Define a procedure `unique-pairs` that, given an integer $n$ , generates the
sequence of pairs $(i,j)$ with $1≤j<i≤n$ . Use `unique-pairs` to simplify the
definition of `prime-sum-pairs` given above.

## Solution

First, we define `unique-pairs`:

```scheme
(define (enumerate-interval low high)
  (if (> low high)
    '()
    (cons low
          (enumerate-interval (+ low 1) high))))

(define (unique-pairs n)
  (accumulate
    append
    '()
    (map (lambda (i)
           (map (lambda (j)
                  (list i j))
                (enumerate-interval 1 (- i 1))))
         (enumerate-interval 2 n))))
```

Now we can simplify the `prime-sum-pairs`:

```scheme
(define (prime-sum-pairs n)
  (map make-pair-sum
       (filter
        prime-sum?
        (unique-pairs n))))
```
