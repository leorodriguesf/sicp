## Exercise 2.61

Give an implementation of `adjoin-set` using the ordered representation. By
analogy with `element-of-set?` show how to take advantage of the ordering to
produce a procedure that requires on the average about half as many steps as
with the unordered representation.

## Solution

```scheme
(define (adjoin-set x set)
  (cond ((null? set) (list x))
        ((= x (car set)) set)
        ((< x (car set)) (cons x set))
        (else (cons (car set) (adjoin-set x (cdr set))))))
```

In the worst case, the item we are adding may be larger than the largest one in
the set, so the number of steps is the same as for the unordered representation.
On the other hand, if we are adding the item on sets of many different sizes we
can expect that sometimes we will be able to add at a point near the beginning
of the list and that other times we will still need to examine most of the list.
On average we should expect to have to examine about half of the items in the
set before adding the new item. Thus the average number of steps required will
be about $n/2$. This is still $Î˜(n)$, but it does save us, on the average, a
factor of 2 in number of steps over the previous implementation.
