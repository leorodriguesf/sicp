## Exercise 2.72

Consider the encoding procedure that you designed in [Exercise 2.68](./2.68.md).
What is the order of growth in the number of steps needed to encode a symbol? Be
sure to include the number of steps needed to search the symbol list at each
node encountered. To answer this question in general is difficult. Consider the
special case where the relative frequencies of the $n$ symbols are as described
in [Exercise 2.71](./2.71.md), and give the order of growth (as a function of
$n$) of the number of steps needed to encode the most frequent and least
frequent symbols in the alphabet.

## Solution

First lets recap what `encode-symbol` does:

- At each node of the tree:
  1. It checks whether the symbol is in the left-branch symbol list
  2. If yes -> go left and preprend `0`\
     If no -> go right and preprend `1`
- This repeats until the symbol is found at a leaf.

The key cost comes from the search through the list of symbols (membership test)
at each branch.

But how many membership tests occur when encoding a symbol at depth $d$?

For any symbol at depth $d$, the encoding procedure:

1. Starts at the root (depth 0)
2. Performs a membership test in the left or right branch
3. Moves one level deeper
4. Repeats
5. Stops when it reaches the leaf at depth $d$

So we do:

- Membership test at depth 0 -> Cost $Θ(n - 1)$
- Membership test at depth 1 -> Cost $Θ(n - 2)$
- ...
- Membership test at depth $d$ -> Cost $Θ(n - 1 - d)$

P.S: remember that the membership test is not performed in the node where we are
at depth $d$ but rather in its left or right branch. This is why we start with
depth 0 -> Cost $Θ(n - 1)$.

$$
\text{Cost at depth }d = Θ(n - 1 - d)
$$

The total cost of encoding a symbol at depth $d$ is calculate by:

$$
T(d) = Θ(n - 1) + Θ(n - 2) + ... + Θ(n - 1 - d)
$$

$$
T(d) = (n - 1) + (n - 2) + ... + (n - 1 - d)
$$

$$
T(d) = \sum_{i=0}^d(n - 1 - i)
$$

$$
T(d) = \sum_{i=0}^d(n - 1) - \sum_{i=0}^di
$$

Because $n-1$ does not depend on $i$, the first sum is just:

$$
\sum_{i=0}^d(n - 1) = (d+1)(n-1)
$$

The second sum is the arithmetic series $0+1+2+...+d$:

$$
S = \sum_{i=0}^di = 0+1+2+...+d
$$

$$
S = 0+1+2+...+(d-2)+(d-1)+d
$$

$$
S = (d-2)+(d-1)+d+...2+1+0
$$

$$
2S = d(d+1)
$$

$$
S = \frac{d(d+1)}{2}
$$

So:

$$
T(d) = (d+1)(n-1) - \frac{d(d+1)}{2}
$$

- The first term is $(d+1)(n-1) = Θ(nd)$
- The seocnd term is $\frac{d(d+1)}{2} = Θ(d^2)$

So overral:

$$
T(d) = Θ(nd - d^2)
$$

- For small $d$, $d^2$ is negligible, and $T(d) \approx Θ(nd)$
- For $d$ proportional to $n$, say $d = cn$, then:

$$
T(d) = Θ(n\cdot cn - (cn)^2) = Θ(n^2(c-c^2)) \approx Θ(n^2)
$$

Thus, the order of growth of the number of steps needed to encode:

### Most frequent symbol

$$
d = 1
$$

$$
T(d) = (d+1)(n-1) - \frac{d(d+1)}{2}
$$

$$
T(1) = (2)(n-1) - \frac{1\cdot 2}{2} = 2n - 2 - 1 = Θ(n)
$$

### Least frequent symbol

$$
d = n - 1
$$

$$
T(d) = (d+1)(n-1) - \frac{d(d+1)}{2}
$$

$$
T(n-1) = (n)(n-1) - \frac{n(n-1)}{2} = \frac{n(n-1)}{2} = Θ(n^2)
$$
